\documentclass[12pt]{article}
 
\usepackage[margin=1in]{geometry} 
\usepackage{amsmath,amsthm,amssymb,scrextend}
\usepackage{fancyhdr}
\setlength{\headheight}{14.5pt}
\addtolength{\topmargin}{-2.5pt}
\pagestyle{fancy}

\newcommand{\cont}{\subseteq}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{amsmath}
\usepackage[mathscr]{euscript}
\let\euscr\mathscr\let\mathscr\relax% just so we can load this and rsfs
\usepackage[scr]{rsfso}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{multicol}
\usepackage[colorlinks=true, pdfstartview=FitV, linkcolor=blue,
citecolor=blue, urlcolor=blue]{hyperref}

\DeclareMathOperator{\arcsec}{arcsec}
\DeclareMathOperator{\arccot}{arccot}
\DeclareMathOperator{\arccsc}{arccsc}
\newcommand{\ddx}{\frac{d}{dx}}
\newcommand{\dfdx}{\frac{df}{dx}}
\newcommand{\ddxp}[1]{\frac{d}{dx}\left(#1 \right)}
\newcommand{\dydx}{\frac{dy}{dx}}
\let\ds\displaystyle
\newcommand{\intx}[1]{\int#1 \, dx}
\newcommand{\intt}[1]{\int#1 \, dt}
\newcommand{\defint}[3]{\int_{#1}^{#2} #3 \, dx}
\newcommand{\imp}{\Rightarrow}
\newcommand{\un}{\cup}
\newcommand{\inter}{\cap}
\newcommand{\ps}{\mathscr{P}}
\newcommand{\set}[1]{\left\{ #1 \right\}}
\newtheorem*{sol}{Solution}
\newtheorem*{claim}{Claim}
\newtheorem{problem}{Problem}
\pgfplotsset{compat=1.17}
\begin{document}
 
% Don't change the above session

\lhead{Financial Engineering hw1}
\chead{111352027}
\rhead{\today}
 
% \maketitle
\section{Two periods Europian put option pricing}
Risk neutral probability $q$

\begin{align*}
    q = \frac{e^{rT}-d}{u-d} = \frac{e^{0.05*\frac{1}{2}}-0.8}{1.2-0.8} = \frac{0.2253}{0.4} = 0.5633
\end{align*}

Find $f_u$ and $f_d$

\begin{align*} 
    f_u &= e^{-rT}[q\times \max(K-S_{0}u^2, 0)+(1-q)\max(K-S_0 ud, 0)]\\
    &= e^{-0.05*\frac{1}{2}}[0.5633\times 0+0.4367\times 4] = 0.9753(0.4367\times 4)=1.704 \\\\
    f_d &= e^{-rT}[q\times \max(K-S_{0}du, 0)+(1-q)\max(K-S_0 d^2, 0)]\\
    &= e^{-0.05*\frac{1}{2}}[0.5633\times 4+0.4367\times 20] = 0.9753(0.5633\times 4 + 0.4367 \times 20)=10.72
\end{align*}

Find $f$

\begin{align*}
    f &= e^{-rT}[q\times \max(K-S_{0}u, 0)+(1-q)\max(K-S_0 d, 0)]\\
    &= e^{-0.05*\frac{1}{2}}[0.5633\times 1.704+0.4367\times 10.72]\\
    &= 0.9753(0.5633\times 1.704 + 0.4367 \times 10.72)=5.5
\end{align*}


\section{Two periods American put option pricing}
In American put option, we need to consider whether the investor will exercise the put option before the expire day.
\begin{enumerate}
    \item When $S_0 u$, the value of early exercise will be $0$, smaller then the value of waiting for expire day which $ = 1.704$
    \item When $S_o d$, the value of early exercise will be $12$, larger then the value of waiting for expire day which $ = 10.72$
\end{enumerate}
So, the price of put option $f$ is

\begin{align*}
    f &= 0.9753(0.5633\times 1.704 + 0.4367 \times 12) = 6.05
\end{align*}

\newpage
\section{The price of Europian call option when $\Delta t = \frac{T}{N}$}
First, according to the two periods Europian call option pricing formula, we know
\begin{align*}
    f_u &= e^{-r\Delta t}[q\times f_{uu}+(1-q)\times f_{ud}]\\ 
    f_d &= e^{-r\Delta t}[q\times f_{du}+(1-q)\times f_{dd}]\\
    f &= e^{-r\Delta t}[q\times f_{u}+(1-q)\times f_{d}]\\
    &= e^{-2r\Delta t}[q^2f_{uu} + 2q(1-q)f_{ud} + (1-q)^2f_{dd}]\\
\end{align*}
So, when $N=3$, we have
\begin{align*}
    f &= e^{-3r\Delta t}\Big[q^3f_{C^3_3 u^3d^0} + 3q^2(1-q)f_{C^3_2 u^2d^1} + 3q(1-q)^2f_{C^3_1 u^1d^2} + (1-q)^3f_{C^3_0 u^0d^3}\Big] 
\end{align*}
From the above formula, we observed that the parameters are following the Binominal Distribution. So the generalized formula when $\Delta t = \frac{T}{N}$ is

\begin{align*}
    f &= e^{-Nr\Delta t}\Big[C_N^N q^N (1-q)^0 f_{C_N^N u^N d^0} + C_{N-1}^{N} q^{N-1} (1-q)^1 f_{C_{N-1}^{N} u^{N-1} d^1} + \cdots + C_0^N q^0 (1-q)^N f_{C_0^N u^0 d^N}\Big]\\
    &= e^{-Nr\Delta t}\Big[\sum_{j=0}^N C^N_j p^j (1-p)^{N-j}\max\big[0, u^j d^{N-j}S-K\big]\Big]
\end{align*}
Let $a$ stand for the minimum number of upward moves that the stock must make over the next n periods for the call to finish in-the-money.\\\\
$\forall\ j<a$,
\[
    \max\big[0, u^j d^{N-j}S-K\big] = 0
\]
$\forall\ j\ge a$,
\[
    \max\big[0, u^j d^{N-j}S-K\big] = u^j d^{N-j}S-K
\]
So,
\begin{align*}
    f &= e^{-Nr\Delta t} \Bigg[\sum_{j=a}^N C^N_j p^j (1-p)^{N-j} \big[u^j d^{N-j}S-K\big]\Bigg]
\end{align*}

\newpage

\section{Issues from \emph{Option Pricing-A Simplified Approach}}
\begin{align*}
    f &= e^{-Nr\Delta t} \Bigg[\sum_{j=a}^N C^N_j p^j (1-p)^{N-j} \big[u^j d^{N-j}S-K\big]\Bigg]\\
    & = S\Bigg[\sum_{j=a}^N C^N_j p^j (1-p)^{N-j} \Bigg(\frac{u^j d^{N-j}}{e^{Nr\Delta t}}\Bigg)\Bigg]-Ke^{-Nr\Delta t}\Bigg[\sum_{j=a}^N C^N_j p^j (1-p)^{N-j}\Bigg]
\end{align*}
We know that 

\[
    \sum_{j=a}^N C^N_j p^j (1-p)^{N-j}
\]
is a complementary Binominal Distribution. So we can denote it as
\[
    \phi(a;N,p)
\]
We also define that

\[
    p'\equiv \frac{u}{e^{Nr\Delta t}}p\quad\  and\quad\  1-p' \equiv \frac{d}{e^{Nr\Delta t}}(1-p)
\]
So

\[
    p^j (1-p)^{N-j} \Bigg[\frac{u^j d^{N-j}}{e^{Nr\Delta t}}\Bigg]=p'^j (1-p')^{N-j}
\]
and

\[
    \sum_{j=a}^N C^N_j p'^j (1-p')^{N-j} = \phi(a;n,p')
\]
Now, we can rewrite the full formula as
\[
    f = S\phi(a;n,p')-Ke^{-Nr\Delta t}\phi(a;n,p)
\]
Assume that $S^*$ is the stock price over $N$ peiods, and there are $j$ upwards. So
\[
    \log(\frac{S^*}{S}) = \log(u^j d^{n-j}) = j\log(\frac{u}{d})+n\log d  
\]
As $j$ is a random variable
\[
    E(\log(\frac{S^*}{S})) = E(j)\log(\frac{u}{d})+n\log d  
\]
\[
    Var(\log(\frac{S^*}{S})) = Var(j)[\log(\frac{u}{d})]^2
\]
\newpage
From the above equations, we know that
\[
    \phi(a;n,p) = P(j\ge a)  
\]
So we can conclude
\[
    1-\phi[a;n,p] = P(j\leq a-1) = P(\frac{j-np}{\sqrt{np(1-p)}}\leq \frac{a-1-np}{\sqrt{np(1-p)}})  
\]
If we consider a stock which in each period will move to $uS$ with probability $p$ and to $dS$ with probability $1-p$, and $\log(\frac{S^*}{S}) = j\log(\frac{u}{d})+n\log(d)$. The mean and variance of this stock are
\[
    \hat{\mu_p} = p\log(\frac{u}{d})+\log d 
\]
\[
    \hat{\sigma^2_p} = p(1-p)[\log(\frac{u}{d})]^2  
\]
Using these equalities, we find that
\[
    \frac{j-np}{\sqrt{np(1-p)}} = \frac{\log(\frac{S^*}{S}) - \hat{\mu_p}n}{\hat{\sigma_p}\sqrt{n}}
\] 
and \footnote[1]{I can't clearly know what actually happends below this equaiton, so I briefly wrote the solution down.}
\[
    \frac{a-1-np}{\sqrt{np(1-p)}} = \frac{\log(\frac{K}{S}) - \hat{\mu_p}n - \varepsilon\log(\frac{u}{d})}{\hat{\sigma_p}\sqrt{n}}  
\]
\\\\
In the continuous time model, and $N\to\infty$, Binominal Distribution asymptotically approaches to the Normal Distribution. So the formula will be\\\\
\begin{align*}
    f = SN(x)-Ke^{-Nr\Delta t}N(x-\sigma \sqrt{t})
\end{align*}
Where
\[
    x \equiv \frac{\log(S/Ke^{-Nr\Delta t})}{\sigma \sqrt{t}}
+\frac{1}{2}\sigma \sqrt{t}\]
% Don't change the below session
 
\end{document}